

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>eqtk.eqcheck &mdash; EQTK 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="eqtk.solveNK" href="../lowlevel/eqtk.solveNK.html" />
    <link rel="prev" title="eqtk.water_density" href="eqtk.water_density.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F0F0" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/eqtk_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quickstart.html">Quick start</a></li>
</ul>
<p class="caption"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core_concepts.html">Core concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../high_level/index.html">High-level interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parsers_and_utilities/index.html">Parsers and utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../low_level_interface.html">EQTK low level interfaces</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api.html#high-level-functions">High-level functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../api.html#parsers-and-utilities">Parsers and utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="eqtk.parse_rxns.html">eqtk.parse_rxns</a></li>
<li class="toctree-l3"><a class="reference internal" href="eqtk.parse_input.html">eqtk.parse_input</a></li>
<li class="toctree-l3"><a class="reference internal" href="eqtk.to_df.html">eqtk.to_df</a></li>
<li class="toctree-l3"><a class="reference internal" href="eqtk.water_density.html">eqtk.water_density</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">eqtk.eqcheck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#low-level-functions">Low-level functions</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../case_studies/ligand_receptor.html">Promiscuous ligand-receptor binding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../case_studies/hcr.html">Hyrbidization chain reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../case_studies/competition_anisotropy.html">Competition anisotropy</a></li>
</ul>
<p class="caption"><span class="caption-text">Credits and citation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../credits_and_citation.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits_and_citation.html#citing-eqtk">Citing EQTK</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">EQTK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
<li><a href="https://github.com/justinbois/eqtk">EQTK repo on GitHub</a></li>

    
  <li class="wy-breadcrumbs-aside">
    
        
        
            <a href="../../../_sources/user_guide/generated/parsers/eqtk.eqcheck.rst.txt" rel="nofollow"> View page source</a>
        
      
    
  </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="eqtk-eqcheck">
<h1>eqtk.eqcheck<a class="headerlink" href="#eqtk-eqcheck" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="eqtk.eqcheck">
<code class="sig-prename descclassname">eqtk.</code><code class="sig-name descname">eqcheck</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">c0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">N</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">K</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logK</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">A</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">G</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'unspecified'</span></em>, <em class="sig-param"><span class="n">G_units</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solvent_density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">293.15</span></em>, <em class="sig-param"><span class="n">c_as_log</span><span class="o">=</span><span class="default_value">'unspecified'</span></em>, <em class="sig-param"><span class="n">normal_A</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">eq_rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">eq_atol</span><span class="o">=</span><span class="default_value">1e-08</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-07</span></em>, <em class="sig-param"><span class="n">tol_zero</span><span class="o">=</span><span class="default_value">1e-12</span></em>, <em class="sig-param"><span class="n">return_detailed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#eqtk.eqcheck" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the satisfaction of equilibrium expressions and
conservation laws.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>array</em><em> or </em><em>DataFrame</em><em>, </em><em>shape c0.shape</em>) – Equilibrium concentrations of all species. <cite>c[i, j]</cite> is the
equilibrium concentration of species <cite>j</cite> for initial
concentrations given by <cite>c0[i, :]</cite> in units given by <cite>units</cite>.</p></li>
<li><p><strong>c0</strong> (<em>array_like</em><em>, </em><em>dict</em><em>, </em><em>Series</em><em>, or </em><em>DataFrame</em><em>, </em><em>shape</em><em> (</em><em>n_points</em><em>, </em><em>n_compounds</em><em>) or </em><em>(</em><em>n_compounds</em><em>, </em><em>)</em><em>, or </em><em>None</em>) – Each row contains the total “initial” concentration of all
possible chemical species in solution. The equilibrium
concentration of all species is computed for each row in <cite>c0</cite>.
<cite>c0[i, j]</cite> is the initial concentration of compound <cite>j</cite> for
calculation <cite>i</cite>. <cite>c0</cite> may also be passed as a Pandas Series
where the indices contain the name of the chemical species and
each value is the “initial concentration.” <cite>c0</cite> may also be
passed as a Pandas DataFrame where each row contains the total
“initial” concentration of all possible compounds in solution
and the column names are the names of the chemical species. If
<cite>c0</cite> is passed as a dict, the dict must be convertible to a
Pandas Series or DataFrame as <cite>pd.Series(c0)</cite> or
<cite>pd.DataFrame(c0)</cite>. If <cite>c</cite> is inputted as a Series or DataFrame
and has initial concentrations, <cite>c0</cite> may be None.</p></li>
<li><p><strong>N</strong> (array_like or DataFrame, default <cite>None</cite>) – Stoichiometic matrix. <cite>N[r, j]</cite> = the stoichiometric coefficient
of compound <cite>j</cite> in chemical reaction <cite>r</cite>. All rows of <cite>N</cite> must
be linearly independent. If entered as a DataFrame, the name of
chemical species <cite>j</cite> is <cite>N.columns[j]</cite>. Optionally, column
<cite>‘equilibrium constant’</cite> contains the equilibrium constants for
each reaction in units commensurate with those of <cite>c0</cite>. If <cite>N</cite>
is given, <cite>A</cite> and <cite>G</cite> cannot be given.</p></li>
<li><p><strong>K</strong> (array_like, shape (n_reactions,), default <cite>None</cite>) – <cite>K[r]</cite> is the equilibrium constant for chemical reaction r in
units commensurate with those of <cite>c0</cite>. If <cite>N</cite> is given as a
DataFrame with an <cite>‘equilibrium constant’</cite> column, <cite>K</cite> should
not be supplied. If <cite>K`is given, `A</cite> and <cite>G</cite> cannot be given.</p></li>
<li><p><strong>logK</strong> (array_like, shape (n_reactions,), default <cite>None</cite>) – <cite>logK[r]</cite> is the natural logarithm of the equilibrium constant
for chemical reaction r. If <cite>logK</cite> is specified, the
concentrations must all be dimensionless (<cite>units=None</cite>). If <cite>N</cite>
is given as a DataFrame with a <cite>‘log equilibrium constant’</cite>
column, <cite>logK</cite> should not be supplied. If <cite>K</cite> is given, <cite>A</cite>,
<cite>G</cite>, and <cite>K</cite> cannot be given.</p></li>
<li><p><strong>A</strong> (<em>array_like</em><em> or </em><em>DataFrame</em><em>, </em><em>n_compounds columns</em>) – Conservation matrix. If <cite>c</cite> is the output, then
<cite>A &#64; c0 = A &#64; c</cite>. All entries must be nonnegative and the rows
of <cite>A</cite> must be linearly independent. If entered as a DataFrame,
the name of chemical species <cite>j</cite> is <cite>A.columns[j]</cite>. If <cite>A</cite> is
given, <cite>G</cite> must be given, and <cite>N</cite> and <cite>K</cite> cannot be given.</p></li>
<li><p><strong>G</strong> (array_like, shape (n_compounds, ), default <cite>None</cite>) – <cite>G[j]</cite> is the free energy of chemical species <cite>j</cite> in units
specified by <cite>G_units</cite>. If <cite>G</cite> is given, <cite>A</cite> must be given, and
<cite>N</cite> and <cite>K</cite> cannot be given.</p></li>
<li><p><strong>names</strong> (list or tuple of str, default <cite>None</cite>, optional) – The names of the chemical species. Names are inferred if <cite>N</cite> or
<cite>A</cite> is given as a DataFrame, in which case <cite>names</cite> is
unnecessary.</p></li>
<li><p><strong>units</strong> (string or <cite>None</cite>, default ‘unspecified’) – The units of the concentrations. Allowable values are {<cite>None</cite>,
‘mole fraction’, ‘molar’, ‘M’, ‘millimolar’, ‘mM’, ‘micromolar’,
‘uM’, ‘µM’, ‘nanomolar’, ‘nM’, ‘picomolar’, ‘pM’}. If
‘unspecified’, units are inferred from other inputs. If the <cite>c</cite>
is a Numpy array, units are considered <cite>None</cite> if ‘unspecified’.
The equilibrium constants given by <cite>K</cite> must have corresponding
units.</p></li>
<li><p><strong>G_units</strong> (string, default <cite>None</cite>) – Units in which free energy is given. If <cite>None</cite> or <cite>‘kT’</cite>, the
free  energies are specified in units of of the thermal energy
kT. Allowable values are {None, ‘kT’, kcal/mol’, ‘J’, ‘J/mol’,
‘kJ/mol’, ‘pN-nm’}.</p></li>
<li><p><strong>solvent_density</strong> (float, default <cite>None</cite>) – The density of the solvent in units commensurate with the
<cite>units</cite> keyword argument. Default (<cite>None</cite>) assumes the solvent
is water, and its density is computed at the temperature
specified by the <cite>T</cite> keyword argument.</p></li>
<li><p><strong>T</strong> (<em>float</em><em>, </em><em>default = 293.15</em>) – Temperature, in Kelvin, of the solution. When <cite>N</cite> and <cite>K</cite> are
given, <cite>T</cite> is ignored if <cite>solvent_density</cite> is given or if
<cite>units</cite> is <cite>None</cite>. If <cite>A</cite> and <cite>G</cite> are given, <cite>T</cite> is ignored when
<cite>units</cite> and <cite>G_units</cite> are both <cite>None</cite>.</p></li>
<li><p><strong>c_as_log</strong> (<em>str</em><em> or </em><em>bool</em><em>, </em><em>default 'unspecified'</em>) – If True, <cite>c</cite> is given with computed concentrations as the
natural logarithm of their value, as would be returned by
<cite>eqtk.solve()</cite> with the <cite>return_log=True</cite> keyword argument. If
‘unspecified’, logarithmic <cite>c</cite> is inferred from the input. If
<cite>c</cite> is a Numpy array and <cite>c_as_log</cite> is ‘unspecified’, the
inputted <cite>c</cite> is assumed to be concentrations and not their
natural logarithms.</p></li>
<li><p><strong>normal_A</strong> (<em>bool</em><em>, </em><em>default True</em>) – If True, perform a transformation on <cite>A</cite> such that its rows are
normal vectors when checking conservation laws. If False, use
inputted <cite>A</cite> directly as the conservation matrix. This is
ignored if <cite>A</cite> is not specified; the resulting conservation
matrix in that case has orthonormal rows by construction. This
parameter should be chosen to match what was used in the
calculation being checked because the convergence criteria
change slightly depending on the particular values in <cite>A</cite>.</p></li>
<li><p><strong>eq_atol</strong> (<em>float</em><em>, </em><em>default 1e-8</em>) – Absolute tolerance parameter to check closeness of equilibrium
as used in <cite>numpy.isclose()</cite>.</p></li>
<li><p><strong>eq_rtol</strong> (<em>float</em><em>, </em><em>default 1e-5</em>) – Relative tolerance parameter to check closeness of equilibrium
condition as used in <cite>numpy.isclose()</cite>.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>default 1e-7</em>) – Tolerance for conservation law. The absolute tolerance for a
given initial concentration c0 (a one-dimensional array) for the
conservation conditions are tol * np.dot(A, c0) except when an
entry in np.dot(A, c0) is zero. If that is the case for entry i,
then the absolute tolerance is tol * np.max(A[i] * c0). If all
entries in A[i] * c0 are zero, which only happens with c0 = 0,
the absolute tolerance is <cite>tol_zero</cite>.</p></li>
<li><p><strong>tol_zero</strong> (<em>float</em><em>, </em><em>default 1e-12</em>) – Absolute tolerance for convergence when the initial
concentrations are all zero. This cannot really be set a priori;
it depends on the scale of the dimensionless concentrations. By
default, assume an absolute tolerance consistent with <cite>tol</cite> and
millimolar mole fractions.</p></li>
<li><p><strong>return_detailed</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, return detailed quantitative checks (see return values
below). If False, only a boolean is returned, True if all
equilibrium and conservation conditions are met and False
otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>output</strong> (<em>bool</em>) – True is all equilibrium and conservation conditions are met.
False otherwise.</p></li>
<li><p><strong>equilibrium_check</strong> (<em>Numpy array, shape (n_points, n_reactions) or (n_reactions, )</em>) – equilibrium_check[i, r] is the ratio of the left and right hand
sides of the mass action expression for equilibrium for
calculation <cite>i</cite>.  This is defined as
(prod_j c[j]**N[r][j]) / K[r]. If <cite>N</cite> or <cite>K</cite> is not
given, they are calculated from <cite>A</cite> and <cite>G</cite>. This is only
returned if <cite>return_detailed</cite> is True.</p></li>
<li><p><strong>equilibrium_satisfied</strong> (<em>Numpy array, shape (n_points, n_reactions) or (n_reactions, )</em>) – equilibrium_satisfied[i, r] is True if the equilibrium condition
for reaction r in calculation i is satisfied.
is met and False otherwise. This is only  returned if
<cite>return_detailed</cite> is True.</p></li>
<li><p><strong>cons_check</strong> (<em>Numpy array, shape (n_points, n_compounds - n_reactions), or (n_compounds - n_reactions,)</em>) – cons_check[i, k] is the difference between the calculated value
of a conserved quantity and the actual value for calculation
<cite>i</cite>. It is defined as cons_check = np.dot(A, c) - np.dot(A, c0).
If <cite>A</cite> is not given, <cite>A</cite> is calculated as the null space of <cite>N</cite>.
This is only returned if <cite>return_detailed</cite> is True.</p></li>
<li><p><strong>cons_satisfied</strong> (<em>Numpy array, shape (n_points, n_reactions) or (n_reactions, )</em>) – cons_satisfied[i, k] is True if the conservation condition k for
calculation i is met and False otherwise. This is only  returned
if <cite>return_detailed</cite> is True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../lowlevel/eqtk.solveNK.html" class="btn btn-neutral float-right" title="eqtk.solveNK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="eqtk.water_density.html" class="btn btn-neutral float-left" title="eqtk.water_density" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> <jinja2.runtime.BlockReference object at 0x627ab5e90> 

<p>© 2020 EQTK Developers.</p>

<p>This document was prepared at <a rel="caltech" href="http://www.caltech.edu">Caltech</a> with financial support from the <a rel="rosen" href="http://rosen.caltech.edu">Donna and Benjamin M. Rosen Bioengineering Center</a>.</p>

<br />

<p>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>.

 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-166791717-1', 'auto');
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>